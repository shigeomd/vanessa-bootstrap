
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область СлужебныеПроцедурыИФункции

// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати.
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	Документы.ВедомостьНаВыплатуЗарплатыВБанк.ДобавитьКомандыПечати(КомандыПечати);
	
КонецПроцедуры

Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	МассивПлатежныхДокументов = Новый Массив;
	МетаданныеПлатежногоДокумента = ОбменСБанкамиПоЗарплатнымПроектам.МетаданныеПлатежногоДокументаПеречисленияЗарплаты();
	Для каждого ОбъектИзМассива Из МассивОбъектов Цикл
		МетаданныеДокумента = ОбъектИзМассива.Метаданные();
		Если (МетаданныеПлатежногоДокумента = Неопределено Или МетаданныеДокумента.ПолноеИмя() <> МетаданныеПлатежногоДокумента.ПолноеИмя()) Тогда
			Продолжить;
		КонецЕсли;
		МассивПлатежныхДокументов.Добавить(ОбъектИзМассива);
	КонецЦикла;
	Для каждого ПлатежныйДокумент Из МассивПлатежныхДокументов Цикл
		ИндексЭлемента = МассивОбъектов.Найти(ПлатежныйДокумент);
		Если ИндексЭлемента <> Неопределено Тогда
			МассивОбъектов.Удалить(ИндексЭлемента);
		КонецЕсли;
	КонецЦикла;
	Если МассивОбъектов.Количество() > 0 Тогда
		Документы.ВедомостьНаВыплатуЗарплатыВБанк.Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода);
	КонецЕсли;
	Если МассивПлатежныхДокументов.Количество() > 0 Тогда
		МенеджерПлатежногоДокумента = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(МетаданныеПлатежногоДокумента.ПолноеИмя());
		МенеджерПлатежногоДокумента.Печать(МассивПлатежныхДокументов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли