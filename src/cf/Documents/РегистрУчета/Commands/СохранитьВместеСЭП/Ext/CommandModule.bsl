
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	СвойстваПрисоединенногоФайла = ПолучитьСвойстваПрисоединенногоФайла(ПараметрКоманды);
	
	Если СвойстваПрисоединенногоФайла.ФайлРегистраУчетаПрисоединен Тогда
		Если СвойстваПрисоединенногоФайла.ПодписанЭП Тогда
			ПрисоединенныеФайлыКлиент.СохранитьВместеСЭП(СвойстваПрисоединенногоФайла.ПрисоединенныйФайл ,СвойстваПрисоединенногоФайла.ДанныеФайла, Новый УникальныйИдентификатор);
		Иначе
			ПрисоединенныеФайлыКлиент.СохранитьФайлКак(СвойстваПрисоединенногоФайла.ДанныеФайла);
		КонецЕсли;
		
	КонецЕсли;

КонецПроцедуры

&НаСервере
Функция ПолучитьСвойстваПрисоединенногоФайла(ДокументРегистр)
	
	СвойстваПрисоединногоФайла   = Документы.РегистрУчета.ПолучитьСвойстваПрисоединенногоФайлаРегистра(ДокументРегистр);
	СвойстваПрисоединногоФайла.Вставить("ФайлРегистраУчетаПрисоединен", СвойстваПрисоединногоФайла.ПрисоединенныйФайл <> Справочники.РегистрУчетаПрисоединенныеФайлы.ПустаяСсылка());
	СвойстваПрисоединногоФайла.Вставить("ДанныеФайла", ПрисоединенныеФайлы.ПолучитьДанныеФайла(СвойстваПрисоединногоФайла.ПрисоединенныйФайл, Новый УникальныйИдентификатор));
	
	Возврат СвойстваПрисоединногоФайла;
	
КонецФункции


